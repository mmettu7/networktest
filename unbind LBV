---
- name: Check LBVserver bound to CSVserver on Netscaler
  hosts: netscaler
  gather_facts: no

  tasks:
    - name: Get LBVserver details
      delegate_to: localhost
      community.mios_module.netscaler_lb_vserver_facts:
        nsip: "{{ netscaler_ip }}"
        nitro_user: "{{ netscaler_username }}"
        nitro_pass: "{{ netscaler_password }}"
        name: "{{ lbvserver_name }}"
      register: lbvserver_details

    - name: Check if LBVserver is bound to CSVserver
      debug:
        msg: "LBVserver {{ lbvserver_name }} is {{ 'bound' if lbvserver_details.lb_vservers[0].csvserver_names else 'not bound' }} to CSVserver"

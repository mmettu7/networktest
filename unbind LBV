---
- name: Check LBVserver bound to CSVserver on Netscaler
  hosts: netscaler
  gather_facts: no

  tasks:
    - name: Check if LBVserver is bound to CSVserver
      delegate_to: localhost
      uri:
        url: "http://{{ netscaler_ip }}/nitro/v1/config/lbvserver_binding/{{ lbvserver_name }}"
        method: GET
        user: "{{ netscaler_username }}"
        password: "{{ netscaler_password }}"
        force_basic_auth: yes
        validate_certs: no
      register: lbvserver_binding_result

    - debug:
        msg: "{{ lbvserver_binding_result.json }}"
